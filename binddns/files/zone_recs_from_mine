{%- if ttl is not defined -%}
  {%- set ittl = ' ' -%}
{%- else -%}
  {%- set ittl = ' ' ~ ttl ~ ' ' -%}
{%- endif -%}

{%- set searchdom = "\w+\." ~ name %}
; A records auto-generated by Salt Mine for {{ searchdom }}
{% set addrs = salt['mine.get'](searchdom, 'network.ip_addrs', 'pcre') -%}

{% if addrs is defined -%}
{%- for node, addrlist in addrs.items() -%}
{{ node }}. {{ ittl }} IN A {{ addrlist|first() }}
{% endfor -%}
{%- endif -%}
